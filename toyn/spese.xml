<config>
  <html-blocks>
    <html-block name="row-spesa">
      <![CDATA[<div id-row='{@field='spesa.id'}' tp-row='spesa' class='row border-bottom pt-2 pb-2 {@field='alt-class'}'>
      
      <!-- large -->
      <div class="col-md-2 clr-g pt-1 d-none d-md-block"><h6>{@dt_format='spesa.dt_spesa','dddd'}</h6>
        <h6 contenteditable fld='dt_spesa' tp-fld='date'>{@dt_format='spesa.dt_spesa','dd/MM/yyyy'}</h6></div>
        
      <div class="col-md-2 d-none d-md-block"><h5>{@field='spesa.tp.title'}</h5><h6 class='clr-lg'>{@field='spesa.tp.note'}</h6></div>    
      <div class="col-md-1 d-none d-md-block"><span class='d-inline-block clr-a c-hand' for-fld='qta'>q.ta</span><h4 contenteditable fld='qta' tp-fld='int'>{@field='spesa.qta'}</h4></div>
      <div class="col-md-2 d-none d-md-block"><span class='d-inline-block clr-a c-hand' for-fld='cosa'>cosa</span><h5 contenteditable fld='cosa'>{@field='spesa.cosa'}</h5></div>
      <div class="col-md-1 d-none d-md-block"><span class='d-inline-block clr-a c-hand' for-fld='prezzo'>prezzo</span><h4 class='no-wrap' contenteditable fld='prezzo' tp-fld='money'>{@dec_format='spesa.prezzo','C'}</h4></div>
      <div class="col-md-1 d-none d-md-block"><span class='d-inline-block clr-a c-hand' for-fld='totale'>totale</span><h4 class='font-weight-bold no-wrap' contenteditable fld='totale' tp-fld='money'>{@dec_format='spesa.totale','C'}</h4></div>      
      
      <div class="col-md-3 d-none d-md-block">
       <div class="badge badge-primary text-left {@if_not_else='spesa.evento','d-none','d-block'}">      
        <h5>{@field='spesa.evento.title'}</h5>        
        <div class='{@if_not='spesa.evento.is_date_diverse','d-none'}'>
          <h6>dal {@dt_format='spesa.evento.dt_da','dddd dd/MM/yyyy'}</h6><h6>al {@dt_format='spesa.evento.dt_a','dddd dd/MM/yyyy'}</h6>
        </div>
        <div class='{@if_not='spesa.evento.is_date_uguali','d-none'}'>
          <h6>il {@dt_format='spesa.evento.dt_da','dddd dd/MM/yyyy'}</h6>
        </div>
       </div>
      </div>
      
      <!-- small -->
      <div class="col-4 d-block d-md-none fs-75 clr-g">
        {@dt_format='spesa.dt_spesa','dddd'}<br/><span contenteditable fld='dt_spesa' tp-fld='date'>{@dt_format='spesa.dt_spesa','dd/MM/yyyy'}</span>
      </div>
      <div class="col-8 d-block d-md-none">      
        <div><span class='d-inline'>{@field='spesa.tp.title'}</span></div>
        <div class="mb-2"><span class='clr-a pr-2 c-hand' for-fld='qta'>q.ta:</span><span contenteditable fld='qta' tp-fld='int'>{@field='spesa.qta'}</span>
        <span class='clr-a pr-2 c-hand' for-fld='cosa'>cosa:</span><span contenteditable fld='cosa'>{@field='spesa.cosa'}</span></div>
        <div><span class='clr-a wd-75 c-hand' for-fld='prezzo'>prezzo: </span><span class='d-inline no-wrap' contenteditable fld='prezzo' tp-fld='money'>{@dec_format='spesa.prezzo','C'}</span></div>
        <div><span class='clr-a wd-75 c-hand' for-fld='totale'>totale: </span><span class='d-inline no-wrap font-weight-bold' contenteditable fld='totale' tp-fld='money'>{@dec_format='spesa.totale','C'}</span></div>      
      </div>
      <div class="col-12 d-block d-md-none"><br/></div>
      <div class="col-3 d-block d-md-none"></div>
      <div class="col-9 d-md-none {@if_not_else='spesa.evento','d-none','d-block''}">
        <div class="d-block badge badge-light text-left"><h6>{@field='spesa.evento.title'}</h6>        
         <div class='{@if_not='spesa.evento.is_date_diverse','d-none'}'>
           <h7 class='d-block'>dal {@dt_format='spesa.evento.dt_da','dddd dd/MM/yyyy'}</h7>
           <h7 class='d-block'>al {@dt_format='spesa.evento.dt_a','dddd dd/MM/yyyy'}</h7>
         </div>
         <div class='{@if_not='spesa.evento.is_date_uguali','d-none'}'>
           <h7 class='d-block'>il {@dt_format='spesa.evento.dt_da','dddd dd/MM/yyyy'}</h7>          
         </div>
        </div>
      </div>
            
  </div>
  ]]>
    </html-block>
  </html-blocks>
  <queries>
    <query name="spese">
      <![CDATA[select {@field='top'} s.spesa_id, s.cosa, s.qta, s.dt_spesa, s.prezzo, s.totale, tp.tipo_spesa_id, tp.tipo_spesa, tp.note as note_tipo_spesa, tp.entrata
  , e.evento_id, e.evento, e.dt_da, e.dt_a, e.note as note_evento
  , tpe.tipo_evento_id, tpe.tipo_evento, tpe.note as note_tipo_evento
 from spese s with(nolock)
 join tipi_spesa tp with(nolock) on tp.tipo_spesa_id = s.tipo_spesa_id
 left join eventi e with(nolock) on e.evento_id = s.evento_id
 left join tipi_evento tpe with(nolock) on tpe.tipo_evento_id = e.tipo_evento_id
 where s.user_id = {@field='user_id'}
 order by dt_spesa desc]]>
    </query>
  </queries>
</config>


